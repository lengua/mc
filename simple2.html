<!DOCTYPE html>
<html class=" -moz-" lang="en"><head>
<meta charset="UTF-8">
<link rel="shortcut icon" type="image/x-icon" href="https://static.codepen.io/assets/favicon/favicon-aec34940fbc1a6e787974dcd360f2c6b63348d4b1f4e06c77743096d55480f33.ico">
<link rel="mask-icon" type="" href="https://static.codepen.io/assets/favicon/logo-pin-8f3771b1072e3c38bd662872f6b673a722f4b3ca2421637d5596661b4e2132cc.svg" color="#111">
<title>CodePen - Metronome</title>
<style media="" data-href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">button,hr,input{overflow:visible}audio,canvas,progress,video{display:inline-block}progress,sub,sup{vertical-align:baseline}html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0} menu,article,aside,details,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{}button,select{text-transform:none}[type=submit], [type=reset],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:ButtonText dotted 1px}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}[hidden],template{display:none}/*# sourceMappingURL=normalize.min.css.map */</style>
<style>
      @import url(https://fonts.googleapis.com/css?family=Open+Sans:400,300,700,600);
@import url(//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css);
body {
  background: #f9f8ec;
  font-family: 'Open Sans', sans-serif;
}

input[type="range"] {
  -webkit-appearance: none !important;
  max-height: 3px;
  position: relative;
  top: -3px;
  background: #DDD;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none !important;
  width: 15px;
  height: 15px;
  position: relative;
  top: -1px;
  background: #222;
}

input[type="checkbox"] {
  display: none;
}

input[type="checkbox"] + label {
  display: inline-block !important;
  height: 15px;
  width: 15px;
  margin: 0px 4px 0px 0px !important;
  padding: 0px;
  position: relative;
  top: 4px;
  background: #FFF;
  cursor: pointer;
}
input[type="checkbox"] + label:before {
  content: "";
  display: inline-block;
  width: 4px;
  height: 8px;
  background: #F38630;
  opacity: 0;
  position: relative;
  top: -5px;
  right: -1px;
  transform: skewX(0deg);
  transition: all 0.24s;
}
input[type="checkbox"] + label:after {
  content: "";
  display: inline-block;
  width: 4px;
  height: 15px;
  background: #F38630;
  opacity: 0;
  position: relative;
  top: -5px;
  right: -3px;
  transform: skewX(0deg);
  transition: all 0.24s;
}

input[type="checkbox"]:checked + label:before {
  transform: skewX(30deg);
  opacity: 1;
}
input[type="checkbox"]:checked + label:after {
  transform: skewX(-30deg);
  opacity: 1;
}

.container {
  width: 100%;
}

header {
  height: 65px;
  background: #879BAD;
  color: #2a353e;
  font-size: 36px;
  font-weight: 400;
  text-align: center;
  padding: 5px;
}

.metronome-container {
  width: 75%;
  height: auto;
  position: relative;
  margin: 40px auto;
  background: #2f2f2f;
}
.metronome-container .options-btn {
  color: #FFF;
  font-size: 22px;
  position: absolute;
  top: 20px;
  right: 15px;
  transform: rotateZ(0deg);
  cursor: pointer;
  transition: transform 0.3s;
}
.metronome-container .options-btn:hover {
  transform: rotateZ(60deg);
}
.metronome-container .options-active {
  max-height: 1000px !important;
  padding: 15px;
  overflow: visible !important;
}
.metronome-container .options {
  max-height: 0px;
  background: #FFF;
  color: #333;
  overflow: hidden;
  transition: all 0.25s;
  position: absolute;
  top: 50px;
  right: 15px;
}
.metronome-container .options .up {
  color: #FFF;
  font-size: 22px;
  position: absolute;
  top: -14px;
  right: 3px;
  z-index: 500;
  transform: rotateZ(180deg);
}
.metronome-container .options label {
  display: block;
  margin-top: 10px;
}
.metronome-container .counter {
  width: 100%;
  padding-bottom: 10px;
  background: #404040;
  text-align: center;
}
.metronome-container .counter .dot {
  width: 15px;
  height: 15px;
  display: inline-block;
  margin: 25px 10px 10px 10px;
  background: #FFF;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s;
}
.metronome-container .counter .active {
  background: #5ec2ff;
}
.metronome-container .controls {
  color: #FFF;
  padding: 20px;
  text-align: center;
}
.metronome-container .controls label {
  display: block;
  margin-bottom: 18px;
}
.metronome-container .controls label span {
  background: #FFF;
  color: #222;
  padding: 5px;
}
.metronome-container .controls label span i {
  cursor: pointer;
  transition: color 0.2s;
}
.metronome-container .controls label span i:hover {
  color: #FA6900;
}
.metronome-container .controls input {
  width: 30px;
  border: 0px solid;
  color: #222;
  text-align: center;
  padding: 4px;
}
.metronome-container .controls select {
  border: 0px;
  color: #222;
}
.metronome-container .controls .play-btn {
  width: 45%;
  background: #D6E26D;
  border: 0px;
  border-radius: 5px;
  padding: 12px;
  color: #3d430d;
  transition: background 0.3s;
}
.metronome-container .controls .play-btn:hover {
  background: #e8efad;
}
.metronome-container .controls .tap-btn {
  width: 45%;
  background: #888;
  border: 0px;
  border-radius: 5px;
  padding: 12px;
  color: #fbfbfb;
  transition: background 0.3s;
}
.metronome-container .controls .tap-btn:hover {
  background: #959595;
}

footer {
  width: 50%;
  height: auto;
  background: #FFF;
  color: #444;
  padding: 10px;
  margin: 50px auto;
}

    </style>
<script>
  window.console = window.console || function(t) {};
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
<script>
  if (document.location.search.match(/type=embed/gi)) {
    window.parent.postMessage("resize", "*");
  }
</script>
</head>
<body translate="no">
<div class="container">
<header style="font-size: 46px;">Simple<b style="color: #FFF;">Metronome</b></header>
<section class="metronome-container">
<div class="counter"><div class="dot active" style=""></div><div class="dot" style=""></div><div class="dot active" style=""></div><div class="dot" style="transform: translateY(-10px); background: rgb(247, 84, 84) none repeat scroll 0% 0%;"></div><div class="dot active" style=""></div><div class="dot" style=""></div><div class="dot active" style=""></div><div class="dot" style=""></div><div class="dot active" style=""></div><div class="dot" style=""></div><div class="dot active" style=""></div></div>
<i class="fa fa-cog options-btn"></i>
<div class="controls">
<label>BPM: <span>
<i class="fa fa-minus bpm-minus"></i>
<input type="text" value="60" class="bpm-input">
<i class="fa fa-plus bpm-plus"></i>
</span>
</label>
<label>
Beat: <input type="text" value="4" class="ts-top"></label>
<div style="margin-bottom: 15px;">
<input type="checkbox" id="timer-check">
<label for="timer-check"></label>
Timer: <input type="text" value="60" class="timer">
</div>
<button class="tap-btn">Tap</button>
<button class="play-btn" style="background: rgb(247, 84, 84) none repeat scroll 0% 0%; color: rgb(255, 255, 255);">Stop</button>
</div>
<div class="options">
<i class="fa fa-caret-down up"></i>
<label>Off Beat Pitch: <input type="range" min="0" max="500" value="200" class="beat-range"></label>
<label>Accent Pitch: <input type="range" min="0" max="500" value="380" class="accent-range"></label>
</div>
</section>
</div>
<footer>
<ul>
<li>Click circles to make an accent on that beat</li>
<li>Best viewed in <b>Google Chrome</b></li>
<li>Use options to change pitches of beats.</li>
</ul>
</footer>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/FitText.js/1.1/jquery.fittext.min.js"></script>
<script id="rendered-js">
      window.AudioContext = window.AudioContext || window.webkitAudioContext;
var context = new AudioContext();
var timer,noteCount,counting,accentPitch = 380,offBeatPitch = 200;
var delta = 0;
var curTime = 0.0;

// Load up dots on pageload
$("document").ready(function () {
  $(".ts-top").trigger("change");
  $("header").fitText(1, { maxFontSize: "46px" });
});


/*
    Scheduling Help by: https://www.html5rocks.com/en/tutorials/audio/scheduling/
    */
function schedule() {
  while (curTime < context.currentTime + 0.1) {if (window.CP.shouldStopExecution(0)) break;
    playNote(curTime);
    updateTime();
  }window.CP.exitedLoop(0);
  timer = window.setTimeout(schedule, 0.1);
}

function updateTime() {
  curTime += 60.0 / parseInt($(".bpm-input").val(), 10);
  noteCount++;
}

/* Play note on a delayed interval of t */
function playNote(t) {
  var note = context.createOscillator();

  if (noteCount == parseInt($(".ts-top").val(), 10))
  noteCount = 0;

  if ($(".counter .dot").eq(noteCount).hasClass("active"))
  note.frequency.value = accentPitch;else

  note.frequency.value = offBeatPitch;

  note.connect(context.destination);

  note.start(t);
  note.stop(t + 0.05);

  $(".counter .dot").attr("style", "");

  $(".counter .dot").eq(noteCount).css({
    transform: "translateY(-10px)",
    background: "#F75454" });

}

function countDown() {
  var t = $(".timer");

  if (parseInt(t.val(), 10) > 0 && counting === true)
  {
    t.val(parseInt(t.val(), 10) - 1);
    window.setTimeout(countDown, 1000);
  } else

  {
    $(".play-btn").click();
    t.val(60);
  }
}

/* Tap tempo */
$(".tap-btn").click(function () {
  var d = new Date();
  var temp = parseInt(d.getTime(), 10);

  $(".bpm-input").val(Math.ceil(60000 / (temp - delta)));
  delta = temp;
});

/* Add or subtract bpm */
$(".bpm-minus, .bpm-plus").click(function () {
  if ($(this).hasClass("bpm-minus"))
  $(".bpm-input").val(parseInt($(".bpm-input").val(), 10) - 1);else

  $(".bpm-input").val(parseInt($(".bpm-input").val(), 10) + 1);
});

/* Change pitches for tones in options */
$(".beat-range, .accent-range").change(function () {
  if ($(this).hasClass("beat-range"))
  offBeatPitch = $(this).val();else

  accentPitch = $(this).val();
});

/* Activate dots for accents */
$(document).on("click", ".counter .dot", function () {
  $(this).toggleClass("active");
});

$(".options-btn").click(function () {
  $(".options").toggleClass("options-active");
});

/* Add dots when time signature is changed */
$(".ts-top, .ts-bottom").on("change", function () {
  var _counter = $(".counter");
  _counter.html("");

  for (var i = 0; i < parseInt($(".ts-top").val(), 10); i++)
  {if (window.CP.shouldStopExecution(1)) break;
    var temp = document.createElement("div");
    temp.className = "dot";

    if (i === 0)
    temp.className += " active";

    _counter.append(temp);
  }window.CP.exitedLoop(1);
});


/* Play and stop button */
$(".play-btn").click(function () {
  if ($(this).data("what") === "pause")
  {
    // ====== Pause ====== //
    counting = false;
    window.clearInterval(timer);
    $(".counter .dot").attr("style", "");
    $(this).data("what", "play").attr("style", "").text("Play");
  } else
  {
    // ====== Play ====== //

    if ($("#timer-check").is(":checked"))
    {
      counting = true;
      countDown();
    }

    curTime = context.currentTime;
    noteCount = parseInt($(".ts-top").val(), 10);
    schedule();

    $(this).data("what", "pause").css({
      background: "#F75454",
      color: "#FFF" }).
    text("Stop");
  }
});
      //# sourceURL=pen.js
    </script>


</body></html>